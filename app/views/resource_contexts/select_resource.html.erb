<h1 class="row-fluid"><span class="icon resource-template"></span>Existing Resources</h1>
<% unless user_role_in?(:dmp_admin) %>
	<h2>For <%= current_user.institution.full_name %></h2>
<% else %>
	<br/>
<% end %>
<div class="row-fluid">
<%= render 'resource_search' %>

<%= form_tag copy_selected_customization_resource_path, :method => :post  do %>

	<table class="table table-striped">
		<thead>
			<tr>
				<th>Select</th>

				<th><%= link_to "Resource Id", 
											{scope: "Resource_id",
											 tab: @tab, 
											customization_overview_id: @customization_overview_id,
											template_id: 		@template_id,
											resource_level: @resource_level,
											tab_number: 		@tab_number,
											custom_origin: 	@custom_origin,
											requirement_id: @requirement_id}%>
				</th>		
				
				<th class="span4"><%= link_to "Details", 
											{scope: "Details", 
											tab: 					@tab,
											customization_overview_id: @customization_overview_id,
											template_id: 		@template_id,
											resource_level: @resource_level,
											tab_number: 		@tab_number,
											custom_origin: 	@custom_origin,
											requirement_id: @requirement_id}%>
				</th>	
				
				<th><%= link_to "Type", 
							{scope: "Type", 
								tab: 												@tab,
								customization_overview_id: 	@customization_overview_id,
								template_id: 								@template_id,
								resource_level: 						@resource_level,
								tab_number: 								@tab_number,
								custom_origin: 							@custom_origin,
								requirement_id: 						@requirement_id} %>
				</th>	

				<th><%= link_to "Institution", 
							{scope: "Institution", 
							tab: 												@tab,
							customization_overview_id: 	@customization_overview_id,
							template_id: 								@template_id,
							resource_level: 						@resource_level,
							tab_number: 								@tab_number,
							custom_origin: 							@custom_origin,
							requirement_id: 						@requirement_id} %>
				</th>	

				<th><%= link_to "Creation Date", 
							{scope: "Creation_Date", 
							 tab: @tab,
							customization_overview_id: @customization_overview_id,
							template_id: 		@template_id,
							resource_level: @resource_level,
							tab_number: 		@tab_number,
							custom_origin: 	@custom_origin,
							requirement_id: @requirement_id} %>
				</th>	

				<th><%= link_to "Last Modification Date", 
							{scope: "Last_Modification_Date",
							 tab: @tab, 
							customization_overview_id: @customization_overview_id,
							template_id: 		@template_id,
							resource_level: @resource_level,
							tab_number: 		@tab_number,
							custom_origin: 	@custom_origin,
							requirement_id: @requirement_id} %>
				</th>
								
				<th>Level</th>
				<th width="span1">Edit</th>
			</tr>
		</thead>
		<tbody>

			<% @resource_contexts.each do |resource_context| %>
				<tr>
					<td class="span1"><%= radio_button_tag :resource, resource_context.resource_id, checked: false %></td>	
					<td><%= resource_context.resource_id %></td>
					<td>
						<div class="toggle-links">
							<%= resource_context.resource.nil? ? " " : resource_context.resource.label %>
						</div>
					</td>
					<td><%= resource_context.resource.nil? ? " " : resource_context.resource.resource_type %></td>	
					<td><%= resource_context.institution.nil? ? " " :  resource_context.institution.nickname %></td>
					<td><%= resource_context.resource.created_at.nil? ? " " :  resource_context.resource.created_at.strftime("%m/%d/%Y %I:%M%p") %></td>
					<td><%= resource_context.resource.updated_at.nil? ? " " :  resource_context.resource.updated_at.strftime("%m/%d/%Y %I:%M%p") %></td>
					<td><%= resource_context.resource_level %></td>
					<td class="span1"><%= link_to raw(''), 
									edit_customization_resource_path(id: resource_context.resource_id, 
														customization_id: @customization_overview_id, 
														template_id: @template_id,
														resource_level: @resource_level,
														requirement_id: @requirement_id,
														tab_number: 		@tab_number,
														tab: 						@tab,
														custom_origin: @custom_origin),
						 			:class => 'icon edit-user' %>
					</td>
				</tr>
			<% end %>

		<tbody>
	</table>

	<div class="buttons pagination">	
		<%= paginate @resource_contexts %>
	</div>


	<%= hidden_field_tag :template_id, @template_id  %>
	<%= hidden_field_tag :resource_level, @resource_level  %>
	<%= hidden_field_tag :requirement_id, @requirement_id  %>
	<%= hidden_field_tag :customization_overview_id, @customization_overview_id %>
	<%= hidden_field_tag :tab, @tab %>


	<div class="actions pull-right">
		
		<%= link_to 'Add another Resource', 
							new_customization_resource_path(template_id: @template_id, 
							customization_overview_id: @customization_overview_id,
							resource_level: @resource_level,
							requirement_id: @requirement_id,
							tab_number: 		@tab_number,
							tab:  					@tab,
							custom_origin: 	@custom_origin), 
							:method => :post, 
							:class => "btn btn-green" %>	

		<%= submit_tag 'Submit',  :class => "btn btn-green" %>
	</div>


<%end%>
	<div class="actions pull-left">
		<%= link_to '<< Back to ' + "#{@custom_origin}", "#{@origin_path}"+'#'+"#{@tab_number}",  :class => "btn" %>
	</div>
</div>

