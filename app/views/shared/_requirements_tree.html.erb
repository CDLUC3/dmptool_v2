<% # this partial should take a local of requirements for it's level in the tree  %>
<ul>
<% requirements.each do |requirement| %>
  <% if requirement.is_group? %>
    <li class="nested_requirements" id="requirement_<%= requirement.id %>">
      <div class="icons">
      	<span class="icon icon-folder-open"></span>
      </div>
      <%= requirement.text_brief %>
        <%= render partial: 'shared/requirements_tree', locals: {requirements: requirement.children} %>
    </li>
  <% else %>
    <li class="listed_requirement <%= (requirement.id.to_s == params[:requirement_id] ? 'current' : '') %>" id="requirement_<%= requirement.id %>">
      	<div class="icons">
      		<span class="icon requirement"></span>
      	</div>
      	<% if requirement.id.to_s == params[:requirement_id] %>
       		<%= requirement.text_brief %>
      	<% else %>
        	<%= link_to requirement.text_brief, details_plan_path(@plan, requirement_id: requirement.id, node_type: 'requirement'), {class: 'requirement_direct_link'} %>
				<% end %>
				<% unless Response.where(requirement_id: requirement.id, plan_id: @plan.id).count < 1 %>
        	<span class="icon confirm" id="complete_icon"></span>
     		<% end %>
		</li>
  <% end %>
<% end %>
</ul>
