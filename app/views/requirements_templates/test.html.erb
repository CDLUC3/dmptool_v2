<style>
  div.option_area {
    float: left;
    clear: left;
    width: 50px;
    height: 20px;
    text-align: right;
    padding: 5px 5px 5px 0px;
  }
  div.label_area {
    float:left;
    clear: right;
    height: 20px;
    padding: 5px 0 5px 0;
  }
  div.folder_label {
    font-size: 1.25em;
    font-weight: bold;
  }

  ul.closed_list {
    display: none;
  }
  ul.opened_list {
    display: block;
  }
</style>

<%# form_tag %>

  <ul>
    <% @rt_tree.each do |k, v| %>
      <% if v.nil? %>
        <li>
          <div class="option_area">
            <%= radio_button_tag(:requirement_id, k.id, false, :class => 'fun') %>
            <i class="icon-file"></i>
          </div>
          <div class="label_area">
            <%= label_tag("requirement_id_#{k.id}", k.name) %>
          </div>
        </li>
      <% else %>
        <li>
          <div class="option_area">
            <i class="icon-folder-close" id="<%= "inst_icon_#{k.id}" %>"></i>
          </div>
          <div class="label_area folder_label">
            <%= link_to(k.name, '#', :id => "inst_folder_#{k.id}") %>
          </div>
        </li>
          <ul class="closed_list" id="<%= "inst_list_#{k.id}" %>">
            <% v.each do |i| %>
              <li>
                <div class="option_area">
                  <%= radio_button_tag(:requirement_id, i.id) %>
                  <i class="icon-file"></i>
                </div>
                <div class="label_area">
                  <%= label_tag("requirement_id_#{i.id}", i.name) %>
                </div>
              </li>
            <% end %>
          </ul>
      <% end %>
    <% end %>
  </ul>
<%# end %>

<script type="text/javascript">
  $('.folder_label').click(function(event) {
    event.preventDefault();
    var list = $('#' + event.target.id.replace(/^inst_folder_/g, 'inst_list_'));
    var icon = $('#' + event.target.id.replace(/^inst_folder_/g, 'inst_icon_'));
    var new_class = ( icon.attr('class') == 'icon-folder-close' ? 'icon-folder-open' : 'icon-folder-close' );
    list.toggle('drop');
    icon.removeClass(icon.attr('class')).addClass(new_class);
  });
</script>